{% assign encounter_id = include.name | replace: ' ', '_' %}
<details>
  <summary>{{ include.name }}</summary>
  <div class="encounter" id="{{ encounter_id }}">
    <div>
      <button onclick="sortEncounter('{{ encounter_id }}.table')" >Sort</button>
      <button onclick="nextTurn('{{ encounter_id }}.table')">Next</button>
      <button onclick="previousTurn('{{ encounter_id }}.table')">Previous</button>
      <button onclick="autoRollInitiative('{{ encounter_id }}.table')" >Auto Roll Initiative</button>
      <button onclick="resetEncounter('{{ encounter_id }}.table')" >Reset</button>
      <button onclick="showAll('{{ encounter_id }}.table')" >Show All</button>
    </div>
    <table id="{{ encounter_id }}.table">
      <tr class="encounter-table-header">
        <th>Character</th>
        <th>Init</th>
        <th>AC</th>
        <th>HP</th>
        <th>STR</th>
        <th>DEX</th>
        <th>CON</th>
        <th>INT</th>
        <th>WIS</th>
        <th>CHA</th>
        <th>Show<br/>Hide</th>
      </tr>

      {% assign encounter = page.encounters | where: "name", include.name | first %}
      {% for entity in encounter.entities %}
        {% increment entity_number %}
        {% assign character = site.data.players | concat: site.data.npcs | concat: site.data.monsters | where: "name", entity | first %}
        {% assign character_id = character.name | replace: ' ', '_' | prepend: "." | prepend: encounter_id | append: "." | append: entity_number %}
        <tr class="entity" id="{{ character_id }}" data-encounter-id="{{ encounter_id }}">
          <td id="{{ character_id }}.name">
            {% if character.link == nil %}
              <a>{{ character.name }}</a>
            {% else %}
              <a target="_blank" rel="noopener noreferrer" href="{{ character.link }}">{{ character.name }}</a>
            {% endif %}
          </td>
          <td id="{{ character_id }}.initiative"><button
            class="roll roll-click input-ctrl-click reset-contextmenu"
            id="{{ character_id }}.initiative.button"
            data-null-format="+{modifier}"
            data-modifier="{{ character.initiative }}"
            data-die="20"/></td>
          <td id="{{ character_id }}.ac">{{ character.ac }}</td>
          <td id="{{ character_id }}.hp"><button
            class="value decrement-click decrement5-ctrl-click increment-contextmenu increment5-ctrl-contextmenu"
            id="{{ character_id }}.hp.button"
            data-format="{value}/{maximumValue}"
            data-maximum-value="{{ character.hp }}"
            data-minimum-value="0"
            data-initial-value="{{ character.hp }}"/></td>
          <td class="ability modifier" id="{{ character_id }}.str">{{ character.abilities.str | divided_by: 2 | minus: 5 }}</td>
          <td class="ability modifier" id="{{ character_id }}.dex">{{ character.abilities.dex | divided_by: 2 | minus: 5 }}</td>
          <td class="ability modifier" id="{{ character_id }}.con">{{ character.abilities.con | divided_by: 2 | minus: 5 }}</td>
          <td class="ability modifier" id="{{ character_id }}.int">{{ character.abilities.int | divided_by: 2 | minus: 5 }}</td>
          <td class="ability modifier" id="{{ character_id }}.wis">{{ character.abilities.wis | divided_by: 2 | minus: 5 }}</td>
          <td class="ability modifier" id="{{ character_id }}.cha">{{ character.abilities.cha | divided_by: 2 | minus: 5 }}</td>
          <td id="{{ character_id }}.hp"><button onclick="showHideRow('{{ character_id }}')"/>Hide</td>
        </tr>
      {% endfor %}

    </table>
  </div>
</details>
