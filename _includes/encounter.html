{% assign encounter_id = include.name | replace: ' ', '_' %}
<details>
  <summary>{{ include.name }}</summary>
  <div class="encounter" id="{{ encounter_id }}">
    <div><button onclick="mapEntities({{ encounter_id }}, rollInitiative);" >Auto Roll Initiative</button></div>
    <table id="{{ encounter_id }}.table">
      <tr>
        <th>Character</th>
        <th>Init</th>
        <th>STR</th>
        <th>DEX</th>
        <th>CON</th>
        <th>INT</th>
        <th>WIS</th>
        <th>CHA</th>
        <th>HP</th>
      </tr>

      {% assign encounter = page.encounters | where: "name", include.name | first %}
      {% for entity in encounter.entities %}
        {% assign character = site.data.pcs | where: "name", entity | first %}
        {% assign character_id = character.name | replace: ' ', '_' | prepend: "." | prepend: encounter_id %}
        <tr class="entity">
          <td>{{ character.name }}</td>
          <td><button
            class="interactive initiative randomize"
            id="{{ character_id }}.initiative"
            onclick="inputValue({{ encounter_id }}, this.id); this.classList.remove('randomize'); sortEntityTable({{ encounter_id }});"
            oncontextmenu="resetValue(event, this.id); this.classList.add('randomize'); sortEntityTable({{ encounter_id }});"
            bonus="{{ character.initiative }}"
            maximumValue="{{ character.initiative | plus: 20 }}"
            minimumValue="{{ character.initiative | plus: 1 }}"
            initialValue="+{{ character.initiative }}">
            {% if character.initiative >= 0 %}
              +{{ character.initiative }}
            {% else %}
              {{ character.initiative }}
            {% endif %}
          </button></td>
          <td id="{{ character_id }}.str">{{ character.abilities.str | divided_by: 2 | minus: 5 }}</td>
          <td id="{{ character_id }}.dex">{{ character.abilities.dex | divided_by: 2 | minus: 5 }}</td>
          <td id="{{ character_id }}.con">{{ character.abilities.con | divided_by: 2 | minus: 5 }}</td>
          <td id="{{ character_id }}.int">{{ character.abilities.int | divided_by: 2 | minus: 5 }}</td>
          <td id="{{ character_id }}.wis">{{ character.abilities.wis | divided_by: 2 | minus: 5 }}</td>
          <td id="{{ character_id }}.cha">{{ character.abilities.cha | divided_by: 2 | minus: 5 }}</td>
          <td><button
            class="interactive"
            id="{{ character_id }}.hp"
            onclick="incrementValue({{ encounter_id }}, this.id);"
            oncontextmenu="decrementValue(event, this.id);"
            maximumValue="{{ character.hp }}"
            minimumValue="0"
            initialValue="{{ character.hp }}">
              {{ character.hp }} / {{ character.hp }}
          </button></td>        </tr>
      {% endfor %}

    </table>
  </div>
</details>
